// Place all the behaviors and hooks related to the matching controller here.
// All this logic will automatically be available in application.js.
if ('serviceWorker' in navigator) {
  console.log('Service Worker is supported');
  navigator.serviceWorker.register("<%= asset_path 'serviceworker.js' %>")
    .then(function(reg) {
      console.log('Successfully registered!', ':^)', reg);
      reg.pushManager.subscribe({ userVisibleOnly: true })
        .then(function(subscription) {
          console.log('endpoint:', subscription.endpoint);
        $.post("/subscribe", { subscription: subscription.toJSON() });
      });
  }).catch(function(error) {
    console.log('Registration failed', ':^(', error);
  });
}